(this["webpackJsonpzhihu-daily"]=this["webpackJsonpzhihu-daily"]||[]).push([[5],{43:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return h})),n.d(e,"e",(function(){return d}));var i={link:"/api/4/"},a=n(46),r=n.n(a),o=r.a.create();o.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",r.a.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),r.a.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)}));var c=o,s=function(){return c.get("".concat(i.link,"stories/latest"))},l=function(t){return c.get("".concat(i.link,"stories/before/").concat(t))},u=function(t){return c.get("".concat(i.link,"story/").concat(t))},h=function(t){return c.get("".concat(i.link,"story/").concat(t,"/long-comments"))},d=function(t){return c.get("".concat(i.link,"story/").concat(t,"/short-comments"))}},47:function(t,e,n){"use strict";function i(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;typeof n!==Date&&(n=new Date(n));var i={"Y+":n.getFullYear().toString(),"m+":(n.getMonth()+1).toString().padStart(2,"0"),"d+":n.getDate().toString().padStart(2,"0"),"H+":n.getHours().toString().padStart(2,"0"),"M+":n.getMinutes().toString().padStart(2,"0"),"S+":n.getSeconds().toString().padStart(2,"0")};for(var a in i)(e=new RegExp("("+a+")").exec(t))&&(t=t.replace(e[1],1===e[1].length?i[a]:i[a].padStart(e[1].length,"0")));return t}function a(t){return new Date(Date.now()+864e5*t)}function r(t){return t=new Date(t).getTime(),parseInt(t/1e3/60/60/24)===parseInt(Date.now()/1e3/60/60/24)}n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return r}))},56:function(t,e,n){},74:function(t,e,n){},75:function(t,e,n){},76:function(t,e,n){},87:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return x}));var i=n(14),a=n(19),r=n(20),o=n(22),c=n(21),s=n(0),l=n.n(s),u=(n(56),n(43)),h=n(6),d=(n(74),function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return Object(r.a)(n,[{key:"getDay",value:function(){return(new Date).getDate()}},{key:"getMonth",value:function(){return["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"][(new Date).getMonth()]+"\u6708"}},{key:"getHello",value:function(){var t=(new Date).getHours();return t<2?"\u65e9\u70b9\u4f11\u606f~":t<6?"\u51cc\u6668\u597d\uff01":t<9?"\u65e9\u4e0a\u597d\uff01":t<12?"\u77e5\u4e4e\u65e5\u62a5":t<14?"\u4e2d\u5348\u597d\uff01":t<19?"\u77e5\u4e4e\u65e5\u62a5":t<24?"\u665a\u4e0a\u597d\uff01":void 0}},{key:"render",value:function(){var t=this;return l.a.createElement("header",null,l.a.createElement("div",{className:"home-head-date"},l.a.createElement("div",{className:"home-head-day"},this.getDay()),l.a.createElement("div",{className:"home-head-month"},this.getMonth())),l.a.createElement("div",{className:"home-head-hello"},this.getHello()),l.a.createElement("div",{className:"home-head-portrait"},l.a.createElement("img",{src:"http://q1.qlogo.cn/g?b=qq&nk=11241066&s=100",alt:"\u5934\u50cf",onClick:function(){return t.props.history.push("/my")}})))}}]),n}(s.Component)),m=Object(h.g)(d),f=(n(75),function(){function t(e,n){Object(a.a)(this,t),this.element=e,this.cycle=n,this.startCoord={x:0,y:0},this.moveCoord={x:0,y:0},this.endCoord={x:0,y:0},this.isMove=!1,this.init()}return Object(r.a)(t,[{key:"init",value:function(){var t=this;this.element.addEventListener("touchstart",(function(e){return t.start(e)}),!1),this.element.addEventListener("touchmove",(function(e){return t.move(e)}),!1),this.element.addEventListener("touchend",(function(e){return t.end(e)}),!1)}},{key:"start",value:function(t){var e=Math.floor(t.touches[0].pageX),n=Math.floor(t.touches[0].pageY);this.startCoord={x:e,y:n},this.cycle.start&&this.cycle.start({element:this.element,event:t,coord:{x:e,y:n}})}},{key:"move",value:function(t){var e=Math.floor(t.touches[0].pageX),n=Math.floor(t.touches[0].pageY),i=this.isMove?Math.floor(e-this.moveCoord.x):0,a=this.isMove?Math.floor(n-this.moveCoord.y):0;this.isMove=!0,this.moveCoord={x:e,y:n},this.cycle.move&&this.cycle.move({element:this.element,event:t,coord:{x:e,y:n},move:{x:i,y:a}})}},{key:"end",value:function(t){this.isMove=!1;var e=Math.floor(t.changedTouches[0].pageX),n=Math.floor(t.changedTouches[0].pageY);this.endCoord={x:e,y:n};var i=Math.floor(e-this.startCoord.x),a=Math.floor(n-this.startCoord.y),r=this.calcDirection(i,a);this.cycle.end&&this.cycle.end({element:this.element,event:t,coord:{x:e,y:n},move:{x:i,y:a},direction:r})}},{key:"calcDirection",value:function(t,e){var n=180*Math.atan2(t,e)/Math.PI;return n<-135||n>=135?"top":n<135&&n>=45?"right":n<45&&n>=-45?"bottom":"left"}}]),t}()),v=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(){var t;return Object(a.a)(this,n),(t=e.call(this)).state={index:0,move:0},t.Timer=0,t.oneWidth=0,t.show=l.a.createRef(),t.carousel=l.a.createRef(),t}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.oneWidth=this.carousel.current.clientWidth,this.carousel.current.addEventListener("touchmove",(function(t){return t.preventDefault()}),{passive:!1}),this.autoCut(),new f(this.show.current,{start:function(){clearInterval(t.Timer),t.testAssign()},move:function(e){var n=e.move.x;t.setState({move:t.state.move+n})},end:function(e){var n=e.direction,i=e.move.x,a=t.oneWidth/4<Math.abs(i);a&&"left"===n&&t.cutIndex(t.state.index+1),a&&"right"===n&&t.cutIndex(t.state.index-1),a&&"top"!==n&&"bottom"!==n||t.transitionMove(),t.autoCut()}})}},{key:"componentWillUnmount",value:function(){clearInterval(this.Timer)}},{key:"autoCut",value:function(){var t=this;this.Timer=setInterval((function(){return t.cutIndex(t.state.index+1)}),5e3)}},{key:"cutIndex",value:function(t){t>this.props.data.length-1&&(t=0),t<0&&(t=this.props.data.length-1),this.cutShow(this.state.index,t),this.setState({index:t})}},{key:"cutShow",value:function(t,e){var n=-(e-t)*this.oneWidth;this.testAssign(),0===t&&e===this.props.data.length-1&&(n=this.oneWidth),t===this.props.data.length-1&&0===e&&(n=-this.oneWidth),this.transitionMove(-t*this.oneWidth+n)}},{key:"transitionMove",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-this.state.index*this.oneWidth;this.show.current.style.transitionDuration="500ms",this.setState({move:t}),this.resetShow()}},{key:"resetShow",value:function(){var t=this;setTimeout((function(){null!=t.carousel.current&&(t.show.current.style.transitionDuration="0s",t.setState({move:-t.state.index*t.oneWidth}),t.show.current.childNodes[t.props.data.length-1].style.transform="",t.show.current.childNodes[0].style.transform="")}),500)}},{key:"testAssign",value:function(){0===this.state.index&&(this.show.current.childNodes[this.props.data.length-1].style.transform="translateX(-".concat(this.props.data.length*this.oneWidth,"px)")),4===this.state.index&&(this.show.current.childNodes[0].style.transform="translateX(".concat(this.props.data.length*this.oneWidth,"px)"))}},{key:"generateShow",value:function(t){var e=this;return l.a.createElement("li",{key:t.id,onClick:function(){return e.props.history.push("/article/"+t.id)}},l.a.createElement("img",{src:t.image,alt:"value.title",ref:this.images}),l.a.createElement("div",{className:"car-shadow",style:{backgroundImage:"linear-gradient(rgba(255, 255, 255, 0), #".concat(t.image_hue.slice(2)," 60%)")}},l.a.createElement("div",{className:"car-content"},l.a.createElement("h2",null,t.title),l.a.createElement("div",null,t.hint))))}},{key:"render",value:function(){var t=this,e=this.state,n=e.index,i=e.move,a=this.props.data;return l.a.createElement("div",{className:"carousel",ref:this.carousel},l.a.createElement("ul",{className:"car-show",ref:this.show,style:{width:a&&this.oneWidth*a.length+"px",transform:"translateX(".concat(i,"px)")}},a&&a.map((function(e){return t.generateShow(e)}))),l.a.createElement("ul",{className:"car-nav"},a&&a.map((function(t,e){return l.a.createElement("li",{key:t.id,className:e===n?"cut":null})}))))}}]),n}(s.Component),p=Object(h.g)(v),y=(n(76),new(function(){function t(){Object(a.a)(this,t),this.top=0,this.testObjs=[],this.init()}return Object(r.a)(t,[{key:"init",value:function(){var t=this;document.body.onscroll=function(){t.top=document.documentElement.scrollTop,t.test()}}},{key:"add",value:function(t){"function"===typeof t||(t.index=0),this.testObjs.push(t)}},{key:"remove",value:function(t){this.testObjs.splice(this.testObjs.indexOf(t),1)}},{key:"test",value:function(){var t=this;this.testObjs.forEach((function(e){if("function"==typeof e)e(t.top);else{for(var n=!0,i=0;i<e.elements.length;i++){var a=e.elements[i];if(t.top<a.clientHeight+a.offsetTop&&t.top>a.offsetTop){e.index!==i&&(e.callback({last:e.elements[e.index],next:e.elements[i]},{last:e.index,next:i}),e.index=i),n=!1;break}}n&&(e.index=void 0)}}))}},{key:"allInView",value:function(t){var e=this.getRect(t);return e.top+t.clientHeight<=(window.innerHeight||document.documentElement.clientWidth||document.body.clientWidth)&&e.top>=0}},{key:"inView",value:function(t){var e=this.getRect(t);return e.top<=(window.innerHeight||document.documentElement.clientWidth||document.body.clientWidth)&&e.top+t.clientHeight>0}},{key:"getRect",value:function(t){var e=t.getBoundingClientRect(),n=document.documentElement.clientTop,i=document.documentElement.clientLeft;return{top:e.top-n,bottom:e.bottom-n,left:e.left-i,right:e.right-i}}}]),t}())),g=n(47),k=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(){var t;return Object(a.a)(this,n),(t=e.call(this)).element=l.a.createRef(),t.testScroll=null,t}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=this.props,n=e.loadArticle,i=e.addArticles,a=e.n;this.testScroll=function(){y.inView(t.element.current)&&(Object(u.d)(t.getNextDay(a())).then((function(t){i(t.data),n(!0)})),y.remove(t.testScroll))},y.add(this.testScroll)}},{key:"componentWillUnmount",value:function(){y.remove(this.testScroll)}},{key:"parseTime",value:function(t){var e=t.slice(4,6);return"".concat("0"===e.slice(0,1)?e.slice(1):e," \u6708 ").concat(t.slice(6)," \u65e5")}},{key:"getNextDay",value:function(t){return Object(g.a)("Ymd",Object(g.c)(-t))}},{key:"toArticle",value:function(t){this.props.history.push("/article/"+t)}},{key:"render",value:function(){var t=this,e=this.props,n=e.time,i=e.stories;return l.a.createElement("div",{className:"article-list",ref:this.element},n&&l.a.createElement("p",null,l.a.createElement("span",null,this.parseTime(n)),l.a.createElement("i",null)),l.a.createElement("ul",null,i&&i.map((function(e){return l.a.createElement("li",{key:e.id,onClick:function(){return t.toArticle(e.id)}},l.a.createElement("div",{className:"article-list-left"},l.a.createElement("h3",null,e.title),l.a.createElement("p",null,e.hint)),l.a.createElement("div",{className:"article-list-right"},l.a.createElement("img",{src:e.images[0],alt:e.title})))}))))}}]),n}(s.Component),b=Object(h.g)(k),x=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(){var t;return Object(a.a)(this,n),(t=e.call(this)).state={news:{},articles:[]},t.isLoad=!0,t.n=0,t}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.c)().then((function(e){t.setState({news:e.data})}))}},{key:"loadArticle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t)return this.isLoad;this.isLoad=t}},{key:"addArticles",value:function(t){this.setState({articles:[].concat(Object(i.a)(this.state.articles),[t])})}},{key:"render",value:function(){var t=this,e=this.state,n=e.news,i=e.articles;return l.a.createElement("div",{className:"home"},l.a.createElement(m,null),l.a.createElement(p,{data:n.top_stories}),l.a.createElement("div",{className:"home-article"},l.a.createElement(b,{key:"today",loadArticle:function(e){return t.loadArticle(e)},addArticles:function(e){return t.addArticles(e)},n:function(){return t.n++},stories:n.stories}),i&&i.map((function(e){return l.a.createElement(b,{key:e.date,loadArticle:function(e){return t.loadArticle(e)},addArticles:function(e){return t.addArticles(e)},n:function(){return t.n++},time:e.date,stories:e.stories})}))))}}]),n}(s.Component)}}]);
//# sourceMappingURL=5.ae36b486.chunk.js.map